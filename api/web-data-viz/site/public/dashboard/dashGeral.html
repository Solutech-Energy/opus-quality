<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="UTF-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Geral | Opus</title>
   <link rel="stylesheet" href="../css/style.css">
</head>

<body>


   <div class="containerGeralDashGeral">

      <div class="DashGeralLeft">
         <div class="navbarDashGeral">

            <svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" fill="currentColor"
               class="bi bi-person-circle" viewBox="0 0 16 16">
               <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z" />
               <path fill-rule="evenodd"
                  d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z" />
            </svg>

            <div class="nomeUsuarioGeral">Olá, <span>Luiz</span></div>

            <div class="buttonSairGeral">
               <span><a href="../index.html">Sair</a></span>
            </div>
         </div>


      </div>


      <div class="sectionGeralAvisos">

         <h2>SPtech - 29 De Julho / E27099</h2>
         <h4>Qualidade Geral do Prédio</h4>


         <div class="cardIndex">
            <div class="leftCard" class="textLeft"><span>Seus índices estão<h2 style="color: #2f8c3d;"> Ótimos</span>
               </h2><span>
                  <div><span>Salas irregulares</span>
                     <h2 style="color: #2f8c3d	;">0</h2>
                  </div>
            </div>
            <div class="rightCard">
               <img src="../assets/img/imgPositivos.png" alt="" width="70%" height="70%">
            </div>

         </div>





         <div class="horizontalLine"></div>


         <div class="Generalmonitoring">
            <h4>Monitoramento Geral</h4>
         </div>



         <div class="sectionCardsGerais">
            <div class="cardSensor">
               <div class="leftGrafico">
                  <div class="textPorTemp">
                     <h3>Temperatura</h3>
                  </div>
                  <div class="porcTemp">
                     <h1>98%</h1>
                  </div>

               </div>
               <div class="rightGrafico"><canvas id="graficoLDR5"></canvas></div>
            </div>




            <div class="cardSensor">
               <div class="leftGrafico">
                  <div class="textPorLum">
                     <h3>Luminosidade</h3>
                  </div>
                  <div class="porcLum">
                     <h1>95%</h1>
                  </div>

               </div>
               <div class="rightGrafico"><canvas id="graficoLM35"></canvas></div>

            </div>

         </div>

      </div>
      <div class="verticalLine"></div>

      <div class="sectionGraficosAbsenteismo">

         <div class="textAbsenteeism">
            <h2>Taxa de Absenteísmo Geral</h2>
         </div>


         <div class="absenteeismGraph">
            <canvas id="graficoAbsenteismo"></canvas>
         </div>

         <div class="legendaGraficoAbsenteismo">
            <div class="legendaLeft">
               <h3>Presença</h3>
               <h2>96%</h2>
            </div>
            <div class="legendaRight">
               <h3>Ausência</h3>
               <h2>4%</h2>

            </div>
         </div>

         <div class="textEnvironments">
            <h3>Ambientes</h3>
            <h4 style="background-color: #EF8A14; padding: 0 7px; border-radius: 7px;">Adicionar +</h4>
         </div>


         <div class="environmentisGeneral ">
            <div class="environmentisLine" id="containerSetores">
               <div class="environments" onclick="window.location.assign('DashboardEspecifica.html')">
                  <div class="textEnvironmentsL1"><a href="../dashboard/DashboardEspecifica.html">Sala Aula 1º Andar</a>
                  </div>
               </div>
               <div class="environments">
                  <div class="textEnvironmentsL1"><a href="../dashboard/DashboardEspecifica.html">Sala Técnica</div></a>
               </div>
            </div>




         </div>



      </div>
</body>

</html>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>

   if (sessionStorage.idSetor == undefined) {
      sessionStorage.idSetor = 1;
   }
   console.log("FK EMPRESA: " + sessionStorage.fkEmpresa);
   fetch(`/medidas/buscarSetores/${sessionStorage.fkEmpresa}`)
      .then(response => response.json())
      .then(data => {
         console.log(data)
         containerSetores.innerHTML = "";
         data.forEach(element => {
            containerSetores.innerHTML += `
               <div class="environments" onclick="abrirSetor(${element.idSetor})">
                  <div class="textEnvironmentsL1"><a href="/dashboard/setor">${element.apelido}</a>
                  </div>
               </div>
           
            `;
         });
      })
      .catch(err => console.log(err));

   function abrirSetor(idSetor) {
      sessionStorage.idSetor = idSetor;
      window.location.assign(`/dashboard/setor`);
   }


   const ctx = document.getElementById('graficoAbsenteismo');

   const graficoAbsenteismo = new Chart(ctx, {
      type: 'doughnut',
      data: {
         datasets: [
            {
               backgroundColor: ['#911313', '#2f8c3d'],
               data: [8, 92],
               borderWidth: 1
            }]
      },
      options: {
         Plugins: {
            legend: {
               labels: ['Ausência (%)', 'Presença (%) ']
            },
            title: {
               display: false,
            }
         },
         scales: {
            display: false,
         }
      }
   });




   const ctx1 = document.getElementById('graficoLDR5');

   const graficoTemperatura = new Chart(ctx1, {
      type: 'doughnut',
      data: {
         datasets: [{
            backgroundColor: ['#5220f5', '#911313'],
            labels: 'Temperatura (ºC))',
            data: [97, 3],
            borderWidth: 1
         },
         ]
      },
      options: {
         Plugins: {
            legend: {
               display: false
            },
            title: {
               display: false,
            }
         },
         scales: {
            display: false,
         }
      }
   });





   const ctx2 = document.getElementById('graficoLM35');

   const graficoLuminosidade = new Chart(ctx2, {
      type: 'doughnut',
      data: {

         datasets: [{
            backgroundColor: ['#a39010', '#911313'],
            labels: 'Luminosidade (Lux)',
            data: [92, 8],
            borderWidth: 1
         },
         ]
      },
      options: {
         Plugins: {
            legend: {
               display: false
            },
            title: {
               display: false,
            }
         },
         scales: {
            display: false,
         }
      }
   });

</script>